(function(global){
'use strict';(function(h){function l(){}function c(a,e,b){b=b||{};e=e||l;var d=e instanceof c,f=b.tick||null,g=b.name||"anonymous";b=b.buffer||(d?e.buffer():[]);this.name=g+"@"+ ++p;this.a={c:f,buffer:b,d:e,b:d,f:a,e:0,h:0,g:0,message:"",state:""};k[this.name]=this;a||m(this,"init")}function m(a,e){var b=a.a;if(""===b.state){switch(e){case "init":b.state=n(b);break;case "pass":++b.h;b.state=n(b);break;case "miss":++b.g;b.state=n(b);break;case "exit":b.state="exit"}b.state&&(b.b?(b.d.message(b.message),
b.d[b.state]()):b.d("pass"===a.a.state?null:Error(a.a.message||"Error: "+a.name),b.buffer),delete k[a.name],b.c=null,b.buffer=null,b.d=null)}return a}function n(a){return a.g>a.e?"miss":a.h>=a.f?"pass":""}function q(){k={};p=0}function g(a,e,b,d){d=d||{};b=b||l;var k=d.arg||null,g=d.name||"Task.run",r=d.buffer||(b instanceof c?b.buffer():[]);d=null;d=a?JSON.parse("[["+a.replace(/\+/g,",").replace(/>/g,"],[").replace(/(\w+)/g,'"$1"')+"]]"):JSON.parse('[["'+Object.keys(e).join('"],["')+'"]]');a=new c(d.length,
b,{name:g,buffer:r});f({b:a,l:d,i:0,j:e,k:k});return a}function f(a){function e(a,b,e){var d=new c(1,e,{name:b});if(b in a.j)try{a.j[b](d,a.k,a.i-1)}catch(f){d.done(f)}else isFinite(b)&&setTimeout(function(){d.pass()},parseInt(b,10)|0)}if(!a.b.isFinished())for(var b=a.l[a.i++],d=new c(b.length,function(b){a.b.done(b);b||f(a)},{buffer:a.b.buffer()}),k=0,g=b.length;k<g;++k)e(a,b[k],d)}var k={},p=0;c.prototype={constructor:c,push:function(a){this.a.buffer&&this.a.buffer.push(a);return this},set:function(a,
e){this.a.buffer&&(this.a.buffer[a]=e);return this},done:function(a){var e=a instanceof Error;e&&this.message(a.message);return e?this.miss():this.pass()},pass:function(){this.a.c&&this.a.c(this.name);return m(this,"pass")},miss:function(){this.a.c&&this.a.c(this.name);return m(this,"miss")},exit:function(){return m(this,"exit")},passfn:function(){var a=this;return function(){a.pass()}},missfn:function(){var a=this;return function(){a.miss()}},state:function(){return this.a.state},buffer:function(){return this.a.buffer},
extend:function(a){this.a.f+=a;return this},message:function(a){this.a.message=a.message||a;return this},missable:function(a){this.a.e+=a;return this},isFinished:function(){return""!==this.a.state}};c.dump=function(a){var e={},b;for(b in k)if(!a||a===b.split("@")[0]){var d=k[b].a;e[b]={junction:d.b,taskCount:d.f,missableCount:d.e,passedCount:d.h,missedCount:d.g,state:d.state}}return JSON.parse(JSON.stringify(e))};c.clear=q;c.drop=q;c.flatten=function(a){return Array.prototype.concat.apply([],a)};
c.arraynize=function(a){return Array.prototype.slice.call(a)};c.objectize=function(a){return Object.keys(a).reduce(function(e,b){e[b]=a[b];return e},{})};c.run=g;c.loop=function(a,e,b,d){var f=Object.keys(a),c=Array(f.length+1).join("_").split("").join(">");d=d||{};d.name=d.name||"Task.loop";return g(c,{_:function(b,d,c){e(b,f[c],a)}},b,d)};"process"in h&&(module.exports=c);h["Task"in h?"Task_":"Task"]=c})((this||0).self||global);
(function(h){function l(){}function c(c,g,f){m(c,function(c,h){var a=URL.createObjectURL(new Blob([h],{type:g}));f(c,a)})}function m(c,g){var f=new XMLHttpRequest;f.addEventListener("load",function(){200<=f.status&&300>f.status?"undefined"===typeof f.response.error?g(null,f.response):g(Error(f.response.error.message),""):g(Error(f.status),"")});f.open("GET",c);f.responseType="arraybuffer";f.send()}var n=h.Task||require("uupaa.task.js");l.createProxyURLs=function(h,g){var f=new n(h.length,function(c,
f){g(c,f)});h.forEach(function(g,h){c(g.url,g.mimeType,function(a,c){f.set(h,c);f.done(a)})})};l.createProxyURL=c;"process"in h&&(module.exports=l);h["WMAppCacheProxy"in h?"WMWMAppCacheProxy_":"WMAppCacheProxy"]=l})((this||0).self||global);
})((this||0).self||global);
