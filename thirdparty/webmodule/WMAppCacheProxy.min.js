(function(global){
'use strict';(function(k){function p(){}function c(a,e,b){b=b||{};e=e||p;var d=e instanceof c,f=b.tick||null,g=b.name||"anonymous";b=b.buffer||(d?e.buffer():[]);this.name=g+"@"+ ++q;this.a={c:f,buffer:b,d:e,b:d,f:a,e:0,h:0,g:0,message:"",state:""};h[this.name]=this;a||m(this,"init")}function m(a,e){var b=a.a;if(""===b.state){switch(e){case "init":b.state=l(b);break;case "pass":++b.h;b.state=l(b);break;case "miss":++b.g;b.state=l(b);break;case "exit":b.state="exit"}b.state&&(b.b?(b.d.message(b.message),
b.d[b.state]()):b.d("pass"===a.a.state?null:Error(a.a.message||"Error: "+a.name),b.buffer),delete h[a.name],b.c=null,b.buffer=null,b.d=null)}return a}function l(a){return a.g>a.e?"miss":a.h>=a.f?"pass":""}function n(){h={};q=0}function g(a,e,b,d){d=d||{};b=b||p;var h=d.arg||null,g=d.name||"Task.run",r=d.buffer||(b instanceof c?b.buffer():[]);d=null;d=a?JSON.parse("[["+a.replace(/\+/g,",").replace(/>/g,"],[").replace(/(\w+)/g,'"$1"')+"]]"):JSON.parse('[["'+Object.keys(e).join('"],["')+'"]]');a=new c(d.length,
b,{name:g,buffer:r});f({b:a,l:d,i:0,j:e,k:h});return a}function f(a){function e(a,b,e){var d=new c(1,e,{name:b});if(b in a.j)try{a.j[b](d,a.k,a.i-1)}catch(f){d.done(f)}else isFinite(b)&&setTimeout(function(){d.pass()},parseInt(b,10)|0)}if(!a.b.isFinished())for(var b=a.l[a.i++],d=new c(b.length,function(b){a.b.done(b);b||f(a)},{buffer:a.b.buffer()}),h=0,g=b.length;h<g;++h)e(a,b[h],d)}var h={},q=0;c.prototype={constructor:c,push:function(a){this.a.buffer&&this.a.buffer.push(a);return this},set:function(a,
e){this.a.buffer&&(this.a.buffer[a]=e);return this},done:function(a){var e=a instanceof Error;e&&this.message(a.message);return e?this.miss():this.pass()},pass:function(){this.a.c&&this.a.c(this.name);return m(this,"pass")},miss:function(){this.a.c&&this.a.c(this.name);return m(this,"miss")},exit:function(){return m(this,"exit")},passfn:function(){var a=this;return function(){a.pass()}},missfn:function(){var a=this;return function(){a.miss()}},state:function(){return this.a.state},buffer:function(){return this.a.buffer},
extend:function(a){this.a.f+=a;return this},message:function(a){this.a.message=a.message||a;return this},missable:function(a){this.a.e+=a;return this},isFinished:function(){return""!==this.a.state}};c.dump=function(a){var e={},b;for(b in h)if(!a||a===b.split("@")[0]){var d=h[b].a;e[b]={junction:d.b,taskCount:d.f,missableCount:d.e,passedCount:d.h,missedCount:d.g,state:d.state}}return JSON.parse(JSON.stringify(e))};c.clear=n;c.drop=n;c.flatten=function(a){return Array.prototype.concat.apply([],a)};
c.arraynize=function(a){return Array.prototype.slice.call(a)};c.objectize=function(a){return Object.keys(a).reduce(function(e,b){e[b]=a[b];return e},{})};c.run=g;c.loop=function(a,e,b,d){var f=Object.keys(a),c=Array(f.length+1).join("_").split("").join(">");d=d||{};d.name=d.name||"Task.loop";return g(c,{_:function(b,d,c){e(b,f[c],a)}},b,d)};"process"in k&&(module.exports=c);k["Task"in k?"Task_":"Task"]=c})((this||0).self||global);
(function(k){function p(n,g,f){c(n,function(c,n){var a=URL.createObjectURL(new Blob([n],{type:g}));f(c,a)})}function c(c,g){var f=new XMLHttpRequest;f.addEventListener("load",function(){200<=f.status&&300>f.status?"undefined"===typeof f.response.error?g(null,f.response):g(Error(f.response.error.message),""):g(Error(f.status),"")});f.open("GET",c);f.responseType="arraybuffer";f.send()}var m=k.Task||require("uupaa.task.js"),l={createProxyURLs:function(c,g){var f=new m(c.length,function(c,f){g(c,f)});
c.forEach(function(c,g){p(c.url,c.m,function(a,c){f.set(g,c);f.done(a)})})}};l.createProxyURL=p;"process"in k&&(module.exports=l);k["WMAppCacheProxy"in k?"WMAppCacheProxy_":"WMAppCacheProxy"]=l})((this||0).self||global);
})((this||0).self||global);
